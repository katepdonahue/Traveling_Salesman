
<%#= render 'map' %>

<script type="text/javascript">
  var data = new Object();
  <% @data.each do |route_id, route_hash| %>
    var routeId = <%= route_id %>;
    data[String(routeId)] = new Object();
    <% route_hash.each do |sub_route_id, address_arr| %>
      var subRouteId = <%= sub_route_id %>;
      var subRouteHash = new Object();
      subRouteHash["origin"] = "<%= address_arr.first %>";
      subRouteHash["destination"] = "<%= address_arr.last %>";
      // subRouteHash["departureTime"] = 1391530628316;
      subRouteHash["travelMode"] = google.maps.TravelMode.DRIVING;
      directionsService.route(subRouteHash, function(response, status) {
        // debugger
        console.log(response)
        console.log(status)
        data[String(routeId)][String(subRouteId)] = response;
        if (status == google.maps.DirectionsStatus.OK) {
          // debugger
          console.log("i got into the if block")
          // data[String(routeId)][String(subRouteId)] = response;
        }
      });
      // debugger
    <% end %>
  <% end %>
</script>



